<script>
async function fetchData() {
    const username = document.getElementById("usernameInput").value.trim();
    const output = document.getElementById("output");

    if (!username) {
        output.textContent = "Error: No username provided.";
        return;
    }

    output.textContent = "Fetching user data...";

    // Helper for proxied fetch
    const proxy = url =>
        `https://corsproxy.io/?${encodeURIComponent(url)}`;

    try {
        // Step 1: Convert username â†’ userId
        const usernameLookup = await fetch(proxy(
            "https://users.roblox.com/v1/usernames/users"
        ), {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({usernames:[username], excludeBannedUsers:false})
        });

        const userData = await usernameLookup.json();

        if (!userData.data || userData.data.length === 0) {
            output.textContent = "User not found.";
            return;
        }

        const user = userData.data[0];
        const userId = user.id;

        // Step 2: Fetch full profile info
        const profileRes = await fetch(proxy(
            `https://users.roblox.com/v1/users/${userId}`
        ));

        const profile = await profileRes.json();

        output.textContent =
            "== ACCOUNT DATA ==\n" +
            `Username: ${profile.name}\n` +
            `Display Name: ${profile.displayName}\n` +
            `User ID: ${profile.id}\n` +
            `Created: ${profile.created}\n\n` +
            `Description:\n${profile.description || "(none)"}\n`;
    }
    catch (err) {
        output.textContent = "Error fetching data.\n" + err;
    }
}
</script>
