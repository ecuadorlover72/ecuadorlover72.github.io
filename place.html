<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>r/place Replica</title>
    <style>
        body {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-color: #f0f0f0;
        }
        #canvas {
            border: 1px solid #ccc;
            image-rendering: pixelated;
        }
        #controls {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 100;
        }
    </style>
</head>
<body>
    <div id="controls">
        <button id="clear">Clear</button>
        <input type="color" id="colorPicker" value="#ff0000">
        <button id="zoomIn">Zoom In</button>
        <button id="zoomOut">Zoom Out</button>
    </div>
    <canvas id="canvas" width="500" height="500"></canvas>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const colorPicker = document.getElementById('colorPicker');
        const clearButton = document.getElementById('clear');
        const zoomInButton = document.getElementById('zoomIn');
        const zoomOutButton = document.getElementById('zoomOut');
        let grid = [];
        let scale = 1;
        let offsetX = 0;
        let offsetY = 0;

        function initGrid() {
            for (let i = 0; i < 500; i++) {
                grid[i] = [];
                for (let j = 0; j < 500; j++) {
                    grid[i][j] = '#ffffff';
                }
            }
            drawGrid();
        }

        function drawGrid() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let i = 0; i < 500; i++) {
                for (let j = 0; j < 500; j++) {
                    ctx.fillStyle = grid[i][j];
                    ctx.fillRect(i * scale + offsetX, j * scale + offsetY, scale, scale);
                }
            }
        }

        canvas.addEventListener('mousemove', (e) => {
            if (e.buttons != 1) return;
            const rect = canvas.getBoundingClientRect();
            const x = Math.floor((e.clientX - rect.left - offsetX) / scale);
            const y = Math.floor((e.clientY - rect.top - offsetY) / scale);
            if (x >= 0 && x < 500 && y >= 0 && y < 500) {
                grid[x][y] = colorPicker.value;
                drawGrid();
                saveGrid();
            }
        });

        clearButton.addEventListener('click', () => {
            initGrid();
            saveGrid();
        });

        zoomInButton.addEventListener('click', () => {
            scale = Math.min(scale * 1.2, 16);
            drawGrid();
        });

        zoomOutButton.addEventListener('click', () => {
            scale = Math.max(scale / 1.2, 1);
            drawGrid();
        });

        function saveGrid() {
            localStorage.setItem('grid', JSON.stringify(grid));
        }

        function loadGrid() {
            const savedGrid = localStorage.getItem('grid');
            if (savedGrid) {
                grid = JSON.parse(savedGrid);
            } else {
                initGrid();
            }
            drawGrid();
        }

        window.addEventListener('load', loadGrid);
    </script>
</body>
</html>